<script>
  
  //includs
//jQuery
//dat.gui
//threejs 

var global = {
  focalLength: 70 
};
//establish gui for updating CameraControl properties
var gui = new dat.GUI();
gui.add(global, 'focalLength', 0, 200);


//basic scene, lighting, and a floor
var env = {
  renderer: new THREE.WebGLRenderer({ alpha: true }),
  scene: new THREE.Scene(),
  camera: new THREE.PerspectiveCamera( global.focalLength, window.innerWidth / window.innerHeight, 0.1, 10000),
  cameraTrack: new THREE.Group(),
  lights: {
    ambient: new THREE.AmbientLight( 0x444444 ),
    directional: new THREE.DirectionalLight( 0xffeedd )
  },
  floor: {
    geom: new THREE.PlaneGeometry( 5, 5, 6, 6),
    material: new THREE.MeshBasicMaterial( { 
      color: 0x444444,
      wireframe: true
    })
  },
  volume: {
    geom: new THREE.BoxGeometry( 5, 5, 5 ),
    material: new THREE.MeshBasicMaterial( { 
      color: 0x02082A,
      wireframe: true
    })
  },
  target: new THREE.Vector3( 0, 1, 0 ),
  waveform: {
    geom: new THREE.Geometry(),
    material: new THREE.LineBasicMaterial({
      color: 0x733738
    })
  }
};
$(env.renderer.domElement).addClass("visualizer");
//Build Meshes
env.floor.mesh = new THREE.Mesh( env.floor.geom, env.floor.material );
env.volume.mesh = new THREE.Mesh( env.volume.geom, env.volume.material );
env.waveform.mesh = new THREE.Line( env.waveform.geom, env.waveform.material);
for(var a = 0; a < 1024; a++){
  env.waveform.geom.vertices.push(new THREE.Vector3(((5 / 1024) * a) - 2.5,2.5,0));
}


//Do Whatever to things that go in the Scene
env.cameraTrack.rotation.y = -0.25;
env.camera.position.z = 8; 
env.camera.position.y = 6.8;
env.cameraTrack.rotation.z = -.5;
env.camera.lookAt(env.target);
env.lights.directional.position.set( 0, 0, 1 ).normalize();
env.volume.mesh.position.y = 2.5;
env.floor.mesh.rotation.x = 90 * Math.PI / 180  ;

//GUI controlled start values of the above object
gui.add(env.cameraTrack.rotation, "y", -3, 3);
gui.add(env.camera.position, "y", 0, 30);
gui.add(env.camera.position, "z", 1, 30);


//Add those things to the scene
env.cameraTrack.add(env.camera);
env.scene.add(env.cameraTrack);
//env.scene.add(env.floor.mesh);
env.scene.add(env.volume.mesh);
env.scene.add(env.lights.ambient);
env.scene.add(env.lights.directional);
env.scene.add(env.waveform.mesh);





//render the scene
function render(){
  requestAnimationFrame(render); 
  
  env.camera.setLens(global.focalLength, 98);
  env.camera.lookAt(env.target);
  env.renderer.render(env.scene, env.camera);
}
render();

//put the renderer on the DOM
document.body.appendChild( env.renderer.domElement ); 

//respond to window resizing
function resize(){
  console.log("he")
  env.camera.aspect = 1;
  env.camera.updateProjectionMatrix();
  env.renderer.setSize( 650, 650);
}
window.addEventListener("resize", resize, false);
resize();

</script>